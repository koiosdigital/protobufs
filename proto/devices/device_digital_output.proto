syntax = "proto3";

package ringbahn.v1;

import "devices/device_common.proto";

// Top-level Digital Output device command message
message DigitalOutputDeviceCommand {
  oneof command {
    // Common commands
    SystemInfoRequest system_info = 1; // Response: SystemInfoResponse
    HeartbeatRequest heartbeat = 2; // Response: HeartbeatResponse
    
    // Digital Output-specific commands
    SetPWMChannelRequest set_channel = 10; // Response: AcknowledgeResponse
    DigitalOutputGetStateRequest get_state = 11; // Response: DigitalOutputState
  }
}

// ===== Digital Output-Specific Commands =====

// Response: AcknowledgeResponse
message SetPWMChannelRequest {
  PWMChannelValue channel = 1;
}

// Response: DigitalOutputState
message DigitalOutputGetStateRequest {}

// Single PWM channel configuration
message PWMChannelValue {
  int32 channel_number = 1; // Channel 0-7 (max 8 channels per device);
  int32 duty_cycle_pct = 2; // PWM duty cycle as percentage (0-100);
  int32 frequency_hz = 3; // PWM frequency in Hz (optional, 0 = use default);
}

// Complete Digital Output device state
message DigitalOutputState {
  int64 timestamp_ms = 1; // When state was captured (milliseconds since epoch);
  repeated PWMChannelValue values = 2; // Max 8 channels;
}
